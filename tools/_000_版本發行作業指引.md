# ç‰ˆæœ¬ç™¼è¡Œä½œæ¥­æŒ‡å¼•

ä»¥ä¸‹èªªæ˜ã€é–©æ‹šè¼¸å…¥æ³•ã€‘ä¹‹ç‰ˆæœ¬ç™¼è¡Œä½œæ¥­ç¨‹åºï¼ŒåŠåŸ·è¡Œæ™‚æœŸä¹‹æŸ¥é©—è¦é»ã€‚

1. æ‰“åŒ…å‰ç½®æº–å‚™ä½œæ¥­ç¨‹åº
2. åŸ·è¡Œã€GitHub ç‰ˆæœ¬ç™¼è¡Œä½œæ¥­ç¨‹åºã€‘
3. ä½¿ç”¨è€…å®‰è£ä½œæ¥­ç¨‹åº

## ä½œæ¥­æµç¨‹

```plantuml
@startuml ç™¼è¡Œä½œæ¥­æŒ‡å¼•
start
:ï¼ˆ1ï¼‰æ‰“åŒ…å‰ç½®æº–å‚™ä½œæ¥­ç¨‹åº;
:ï¼ˆ2ï¼‰åŸ·è¡Œã€GitHub ç‰ˆæœ¬ç™¼è¡Œä½œæ¥­ç¨‹åºã€‘;
:ï¼ˆ3ï¼‰ä½¿ç”¨è€…å®‰è£ä½œæ¥­ç¨‹åº;
stop
@enduml
```

## ï¼ˆ1ï¼‰æ‰“åŒ…å‰ç½®æº–å‚™ä½œæ¥­ç¨‹åº

```plantuml
@startuml github_publish_procedure
title æ‰“åŒ…ä½œæ¥­æµç¨‹åœ–

start
:å»ºç½®ã€æ‰“åŒ…æª”æ¡ˆæ¸…å–®ã€‘;
:å»ºç½®ã€GitHubç™¼è¡Œä½œæ¥­è…³æœ¬æª”ã€‘;
stop
@enduml
```

### å»ºç½ã€æ‰“åŒ…æª”æ¡ˆæ¸…å–®ã€‘

å»ºç½®ä¸€æ¸…å–®ï¼Œæè¿°å³å°‡ç™¼è¡Œä¹‹ç‰ˆæœ¬ï¼Œè©²ç™¼è¡Œå¥—ä»¶åŒ…ä¸­ï¼ˆå£“ç¸®æª”æ¡ˆï¼‰ï¼Œæ‡‰åŒ…å«ä¹‹æª”æ¡ˆåŠç›®éŒ„ã€‚

```powershell
# --- å…±ç”¨å‡½å¼åº«/å·¥å…· ---
keymap_piau_tian.yaml
bp_libs_hst_phing_im.yaml
bp_libs_hst_zu_im.yaml
bp_libs.yaml
custom_phrase.txt
rime.lua

# --- éµç›¤æŒ‰éµç·´ç¿’å·¥å…· ---
bp_kb_zu_im.schema.yaml

# --- ã€é–©æ‹¼æ–¹æ¡ˆè¼¸å…¥æ³•ã€‘ ---
bp_hong_im.schema.yaml
bp_phing_im.schema.yaml
bp_ji_khoo.dict.yaml

# å…¶ä»–æª”æ¡ˆ...
requirements.txt
packing_list.txt
rime_install.exe
```

### å»ºç½®ã€GitHubç™¼è¡Œä½œæ¥­è…³æœ¬æª”ã€‘

å»ºç½® GitHub Actions Workflow: release-yamls.yml YAML Script
ï¼Œä½¿ GitHub åœ¨æ”¶æ¥ç²ã€ç‰ˆæœ¬æ¨™ç±¤(Tag)ã€‘æ¨é€è¦æ±‚æ™‚ï¼Œä¾¿è§¸ç™¼ GitHub ä¹‹ç™¼è¡Œ(Release)ä½œæ¥­ã€‚å®Œæˆ GitHub å°ˆæ¡ˆç”£å“ä¹‹ç™¼è¡Œã€‚

```powershell

```


## ï¼ˆ2ï¼‰åŸ·è¡Œã€GitHub ç‰ˆæœ¬ç™¼è¡Œä½œæ¥­ç¨‹åºã€‘

```plantuml
@startuml github_publish_procedure
title GitHub ç™¼è¡Œä½œæ¥­æµç¨‹åœ–

start
:å»ºç½®ã€ç‰ˆæœ¬ç™¼è¡Œæ¨™ç±¤(Tag)ã€‘;
:ç°½å…¥æœ¬åœ°ç«¯;
:æ¨é€åˆ° GitHub ç«¯;
:åŸ·è¡Œ GitHub Actions Workflow;
:é©—è­‰ GitHub ç™¼è¡Œä½œæ¥­åŸ·è¡Œçµæœ;
if (Actions Error Log) then (æ˜¯)
    :è™•ç†ç™¼è¡Œä½œæ¥­ç„¡æ³•æˆåŠŸä¹‹å•é¡Œ;
else (å¦)
    :é©—è­‰ç™¼è¡Œä½œæ¥­æˆåŠŸå®Œæˆ;
endif
stop
@enduml
```

## ï¼ˆ3ï¼‰ä½¿ç”¨è€…å®‰è£ä½œæ¥­ç¨‹åº

1. ç¨‹å¼åˆå§‹åŒ–

    - å»ºç«‹ RimeInstaller å¯¦ä¾‹
    - æ™ºèƒ½æª¢æ¸¬è³‡æºç›®éŒ„ä½ç½®ï¼ˆç•¶å‰ç›®éŒ„ã€åŸ·è¡Œæª”ç›®éŒ„ç­‰ï¼‰

2. RIME å®‰è£æª¢æŸ¥

    - æª¢æŸ¥ RIME é…ç½®ç›®éŒ„æ˜¯å¦å­˜åœ¨
    - å¦‚æœä¸å­˜åœ¨å‰‡æç¤ºå®‰è£ RIME å°ç‹¼æ¯«

3. å‚™ä»½ç¾æœ‰æª”æ¡ˆ

   - å‚™ä»½ default.custom.yaml
   - å‚™ä»½ rime.lua å’Œ custom_phrase.txt

4. è¤‡è£½ RIME é…ç½®æª”æ¡ˆ

   - æª¢æŸ¥æ˜¯å¦æœ‰ rime_files ç›®éŒ„
   - å¦‚æœæœ‰ï¼šå¾ rime_files ç›®éŒ„è¤‡è£½æ‰€æœ‰æª”æ¡ˆ
   - å¦‚æœæ²’æœ‰ï¼šå¾ release-include.txt æŒ‡å®šçš„æª”æ¡ˆåˆ—è¡¨è¤‡è£½

5. è¤‡è£½ default.custom.yaml

   - å„ªå…ˆå¾ rime_files ç›®éŒ„è¤‡è£½
   - å›é€€åˆ° config ç›®éŒ„

6. RIME é‡æ–°éƒ¨ç½²

   - æœå°‹ä¸¦åŸ·è¡Œ WeaselDeployer.exe
   - è§¸ç™¼ RIME é‡æ–°éƒ¨ç½²

7. å®Œæˆå ±å‘Š

   - é¡¯ç¤ºå®‰è£çµ±è¨ˆ
   - æä¾›å¾ŒçºŒæ­¥é©Ÿèªªæ˜

```plantuml
@startuml rime_installer_flowchart
title é–©æ‹šè¼¸å…¥æ³•å®‰è£ä½œæ¥­æµç¨‹åœ–

start
:ç¨‹å¼å•Ÿå‹•;
:å»ºç«‹ RimeInstaller å¯¦ä¾‹ <<procedure>>;
note right
  æ™ºèƒ½æª¢æ¸¬è³‡æºç›®éŒ„ä½ç½®:
  - ç•¶å‰ç›®éŒ„
  - åŸ·è¡Œæª”ç›®éŒ„
  - ä¸Šç´šç›®éŒ„
  - åŸ·è¡Œæª”ä¸Šç´šç›®éŒ„
end note

:åŸ·è¡Œ install() æ–¹æ³•;

:é¡¯ç¤ºå®‰è£ç¨‹å¼æ¨™é¡Œ;

:æª¢æŸ¥ RIME æ˜¯å¦å·²å®‰è£ <<procedure>>;
if (RIME é…ç½®ç›®éŒ„å­˜åœ¨?) then (æ˜¯)
  :âœ… æ‰¾åˆ° RIME é…ç½®ç›®éŒ„;
else (å¦)
  :âŒ RIME é…ç½®ç›®éŒ„ä¸å­˜åœ¨;
  :æç¤ºå®‰è£ RIME å°ç‹¼æ¯«;
  stop
endif

:å‚™ä»½ç¾æœ‰çš„ default.custom.yaml <<procedure>>;
if (default.custom.yaml å­˜åœ¨?) then (æ˜¯)
  :å»ºç«‹æ™‚é–“æˆ³è¨˜å‚™ä»½æª”æ¡ˆ;
  :ğŸ“‹ è¤‡è£½å‚™ä»½æª”æ¡ˆ;
else (å¦)
  :ğŸ“‹ ç„¡éœ€å‚™ä»½;
endif

:å‚™ä»½å…¶ä»–ç¾æœ‰æª”æ¡ˆ <<procedure>>;
note right
  å‚™ä»½æª”æ¡ˆåˆ—è¡¨:
  - rime.lua
  - custom_phrase.txt
end note

partition "è¤‡è£½ RIME é…ç½®æª”æ¡ˆ" {
  :æª¢æŸ¥æ˜¯å¦æœ‰ rime_files ç›®éŒ„ <<procedure>>;

  if (rime_files ç›®éŒ„å­˜åœ¨?) then (æ˜¯)
    :ğŸ“ å¾ rime_files ç›®éŒ„è¤‡è£½æ‰€æœ‰æª”æ¡ˆ;
    :éæ­· rime_files ç›®éŒ„ä¸­çš„æª”æ¡ˆ;
    while (é‚„æœ‰æª”æ¡ˆ?) is (æ˜¯)
      :è¤‡è£½æª”æ¡ˆåˆ° RIME é…ç½®ç›®éŒ„;
      if (è¤‡è£½æˆåŠŸ?) then (æ˜¯)
        :âœ… è¨˜éŒ„æˆåŠŸ;
        :æˆåŠŸè¨ˆæ•¸ +1;
      else (å¦)
        :âŒ è¨˜éŒ„å¤±æ•—;
        :åŠ å…¥å¤±æ•—æ¸…å–®;
      endif
    endwhile (å¦)
  else (å¦)
    :ğŸ“‹ å¾ release-include.txt è¤‡è£½æª”æ¡ˆ;
    :è§£æ release-include.txt;
    while (é‚„æœ‰æª”æ¡ˆ?) is (æ˜¯)
      if (ä¾†æºæª”æ¡ˆå­˜åœ¨?) then (æ˜¯)
        :è¤‡è£½æª”æ¡ˆåˆ° RIME é…ç½®ç›®éŒ„;
        if (è¤‡è£½æˆåŠŸ?) then (æ˜¯)
          :âœ… è¨˜éŒ„æˆåŠŸ;
          :æˆåŠŸè¨ˆæ•¸ +1;
        else (å¦)
          :âŒ è¨˜éŒ„å¤±æ•—;
          :åŠ å…¥å¤±æ•—æ¸…å–®;
        endif
      else (å¦)
        :âš ï¸ æª”æ¡ˆä¸å­˜åœ¨;
        :åŠ å…¥å¤±æ•—æ¸…å–®;
      endif
    endwhile (å¦)
  endif

  :ğŸ“Š é¡¯ç¤ºè¤‡è£½çµæœçµ±è¨ˆ;
}

:è¤‡è£½æ–°çš„ default.custom.yaml <<procedure>>;
if (rime_files/default.custom.yaml å­˜åœ¨?) then (æ˜¯)
  :âœ… å¾ rime_files è¤‡è£½;
else (å¦)
  if (config/default.custom.yaml å­˜åœ¨?) then (æ˜¯)
    :âœ… å¾ config è¤‡è£½;
  else (å¦)
    :âš ï¸ æ‰¾ä¸åˆ° default.custom.yaml;
  endif
endif

:ğŸ”„ å˜—è©¦è§¸ç™¼ RIME é‡æ–°éƒ¨ç½² <<procedure>>;
:æœå°‹ WeaselDeployer.exe;
if (æ‰¾åˆ°éƒ¨ç½²ç¨‹å¼?) then (æ˜¯)
  :åŸ·è¡Œ WeaselDeployer.exe /deploy;
  if (éƒ¨ç½²æˆåŠŸ?) then (æ˜¯)
    :âœ… RIME é‡æ–°éƒ¨ç½²æˆåŠŸ;
  else (å¦)
    :âš ï¸ è‡ªå‹•éƒ¨ç½²å¤±æ•—;
  endif
else (å¦)
  :âš ï¸ æ‰¾ä¸åˆ°éƒ¨ç½²ç¨‹å¼;
endif

:é¡¯ç¤ºå®‰è£å®Œæˆè¨Šæ¯;
:ğŸ“ é¡¯ç¤ºå¾ŒçºŒæ­¥é©Ÿèªªæ˜;
:ğŸ“Š é¡¯ç¤ºå®‰è£çµ±è¨ˆ;

if (æœ‰å¤±æ•—æª”æ¡ˆ?) then (æ˜¯)
  :âš ï¸ éƒ¨åˆ†å•é¡Œ;
else (å¦)
  :âœ… å…¨éƒ¨æˆåŠŸ;
endif

:æŒ‰ Enter éµçµæŸ;

stop

@enduml
```


## åƒè€ƒ
